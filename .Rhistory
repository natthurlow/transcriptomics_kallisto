stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P30AchPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P30AchPCA.svg", P30AchPCA_plot)
### P20 PT
P20PTData <- Data %>% filter(Tendon == "PT", Age == "P20")
P20PT_PCAData <- P20PTData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P20PTPCA <- PCA(P20PT_PCAData, graph = FALSE)
P20PTPCA_wid <- tibble(Sample = P20PTData$SampleName, ComboID = paste0(P20PTData$Age, "-", P20PTData$Genotype), Age = P20PTData$Age, Tendon = P20PTData$Tendon, Genotype = P20PTData$Genotype, PC1 = P20PTPCA$ind$coord[,1], PC2 = P20PTPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P20PTPCA_plot <- P20PTPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
geom_text_repel(aes(label = Sample))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P20PTPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P20PTPCA.svg", P20PTPCA_plot)
### P20 Ach
P20AchData <- Data %>% filter(Tendon == "Ach", Age == "P20")
P20Ach_PCAData <- P20AchData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P20AchPCA <- PCA(P20Ach_PCAData, graph = FALSE)
P20AchPCA_wid <- tibble(Sample = P20AchData$SampleName, ComboID = paste0(P20AchData$Age, "-", P20AchData$Genotype), Age = P20AchData$Age, Tendon = P20AchData$Tendon, Genotype = P20AchData$Genotype, PC1 = P20AchPCA$ind$coord[,1], PC2 = P20AchPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P20AchPCA_plot <- P20AchPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
geom_text_repel(aes(label = Sample))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P20AchPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P20AchPCA.svg", P20AchPCA_plot)
### P10 PT
P10PTData <- Data %>% filter(Tendon == "PT", Age == "P10")
P10PT_PCAData <- P10PTData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P10PTPCA <- PCA(P10PT_PCAData, graph = FALSE)
P10PTPCA_wid <- tibble(Sample =P10PTData$SampleName, ComboID = paste0(P10PTData$Age, "-", P10PTData$Genotype), Age = P10PTData$Age, Tendon = P10PTData$Tendon, Genotype = P10PTData$Genotype, PC1 = P10PTPCA$ind$coord[,1], PC2 = P10PTPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P10PTPCA_plot <- P10PTPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P10PTPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P10PTPCA.svg", P10PTPCA_plot)
### P10 Ach
P10AchData <- Data %>% filter(Tendon == "Ach", Age == "P10")
P10Ach_PCAData <- P10AchData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P10AchPCA <- PCA(P10Ach_PCAData, graph = FALSE)
P10AchPCA_wid <- tibble(Sample = P10AchData$SampleName, ComboID = paste0(P10AchData$Age, "-", P10AchData$Genotype), Age = P10AchData$Age, Tendon = P10AchData$Tendon, Genotype = P10AchData$Genotype, PC1 = P10AchPCA$ind$coord[,1], PC2 = P10AchPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P10AchPCA_plot <- P10AchPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P10AchPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P10AchPCA.svg", P10AchPCA_plot)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(readxl)
library(RColorBrewer)
library(forcats)
library(scales)
library(openxlsx)
library(reshape2)
library(factoextra)
library(FactoMineR)
library(ggprism)
library(ggrepel)
library(rstatix)
# Read in Data
Data <- read_excel("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/FinalData/DeltaCt_Wide.xlsx") %>%
mutate(SampleName = as_factor(SampleName), Age = as_factor(Age), Genotype = as_factor(Genotype), Tendon = as_factor(Tendon))
# recode to match ColXI paper existing figures
Data$Age <- recode_factor(Data$Age, p10 = "P10", p20 = "P20", p30 = "P30")
Data$Genotype <- recode_factor(Data$Genotype, WT = "CTRL")
# order factors
Data$Genotype <- factor(Data$Genotype, levels = c("CTRL", "HET", "KO"))
Data$Age <- factor(Data$Age, levels = c("P10", "P20", "P30"))
# remove idenitifers and housekeepers for data run through PCA
PCAData <- Data %>%
select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
colXIpalette <- c('#000000', '#ff0000', '#0432ff') # CTRL, HET, KO
# Global PCA
globalPCA <- PCA(PCAData, graph = FALSE)
globalPCA_wid <- tibble(Sample = Data$SampleName, ComboID = paste0(Data$Age, "-", Data$Genotype), Age = Data$Age, Tendon = Data$Tendon, Genotype = Data$Genotype, PC1 = globalPCA$ind$coord[,1], PC2 = globalPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
# PCA Plot by Genotype
globalPCA_genoplot <- globalPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
geom_text_repel(aes(label = Sample))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
globalPCA_genoplot
# PCA Plot by Age
globalPCA_ageplot <- globalPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Age, fill = Age)) +
geom_point(size = 2)+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_brewer(palette = 'Set2')+
scale_fill_brewer(palette = 'Set2')+
theme_bw()
globalPCA_ageplot
# PCA Plot by Tendon
globalPCA_tendplot <- globalPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Tendon, fill = Tendon)) +
geom_point(size = 2)+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_brewer(palette = 'Set1')+
scale_fill_brewer(palette = 'Set1')+
theme_bw()
globalPCA_tendplot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/OtherPCAPlots/GlobalPCA-Genotype.svg", globalPCA_genoplot)
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/OtherPCAPlots/GlobalPCA-Age.svg", globalPCA_ageplot)
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/OtherPCAPlots/GlobalPCA-Tendon.svg", globalPCA_tendplot)
# PCA by Age-Tendon
### P30 PT
P30PTData <- Data %>% filter(Tendon == "PT", Age == "P30")
P30PT_PCAData <- P30PTData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P30PTPCA <- PCA(P30PT_PCAData, graph = FALSE)
P30PTPCA_wid <- tibble(Sample = P30PTData$SampleName, ComboID = paste0(P30PTData$Age, "-", P30PTData$Genotype), Age = P30PTData$Age, Tendon = P30PTData$Tendon, Genotype = P30PTData$Genotype, PC1 = P30PTPCA$ind$coord[,1], PC2 = P30PTPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P30PTPCA_plot <- P30PTPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
geom_text_repel(aes(label = Sample))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P30PTPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P30PTPCA.svg", P30PTPCA_plot)
### P30 Ach
P30AchData <- Data %>% filter(Tendon == "Ach", Age == "P30")
P30Ach_PCAData <- P30AchData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P30AchPCA <- PCA(P30Ach_PCAData, graph = FALSE)
P30AchPCA_wid <- tibble(Sample = P30AchData$SampleName, ComboID = paste0(P30AchData$Age, "-", P30AchData$Genotype), Age = P30AchData$Age, Tendon = P30AchData$Tendon, Genotype = P30AchData$Genotype, PC1 = P30AchPCA$ind$coord[,1], PC2 = P30AchPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P30AchPCA_plot <- P30AchPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
geom_text_repel(aes(label = Sample))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P30AchPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P30AchPCA.svg", P30AchPCA_plot)
### P20 PT
P20PTData <- Data %>% filter(Tendon == "PT", Age == "P20")
P20PT_PCAData <- P20PTData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P20PTPCA <- PCA(P20PT_PCAData, graph = FALSE)
P20PTPCA_wid <- tibble(Sample = P20PTData$SampleName, ComboID = paste0(P20PTData$Age, "-", P20PTData$Genotype), Age = P20PTData$Age, Tendon = P20PTData$Tendon, Genotype = P20PTData$Genotype, PC1 = P20PTPCA$ind$coord[,1], PC2 = P20PTPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P20PTPCA_plot <- P20PTPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
geom_text_repel(aes(label = Sample))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P20PTPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P20PTPCA.svg", P20PTPCA_plot)
### P20 Ach
P20AchData <- Data %>% filter(Tendon == "Ach", Age == "P20")
P20Ach_PCAData <- P20AchData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P20AchPCA <- PCA(P20Ach_PCAData, graph = FALSE)
P20AchPCA_wid <- tibble(Sample = P20AchData$SampleName, ComboID = paste0(P20AchData$Age, "-", P20AchData$Genotype), Age = P20AchData$Age, Tendon = P20AchData$Tendon, Genotype = P20AchData$Genotype, PC1 = P20AchPCA$ind$coord[,1], PC2 = P20AchPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P20AchPCA_plot <- P20AchPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
geom_text_repel(aes(label = Sample))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P20AchPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P20AchPCA.svg", P20AchPCA_plot)
### P10 PT
P10PTData <- Data %>% filter(Tendon == "PT", Age == "P10")
P10PT_PCAData <- P10PTData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P10PTPCA <- PCA(P10PT_PCAData, graph = FALSE)
P10PTPCA_wid <- tibble(Sample =P10PTData$SampleName, ComboID = paste0(P10PTData$Age, "-", P10PTData$Genotype), Age = P10PTData$Age, Tendon = P10PTData$Tendon, Genotype = P10PTData$Genotype, PC1 = P10PTPCA$ind$coord[,1], PC2 = P10PTPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P10PTPCA_plot <- P10PTPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P10PTPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P10PTPCA.svg", P10PTPCA_plot)
### P10 Ach
P10AchData <- Data %>% filter(Tendon == "Ach", Age == "P10")
P10Ach_PCAData <- P10AchData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P10AchPCA <- PCA(P10Ach_PCAData, graph = FALSE)
P10AchPCA_wid <- tibble(Sample = P10AchData$SampleName, ComboID = paste0(P10AchData$Age, "-", P10AchData$Genotype), Age = P10AchData$Age, Tendon = P10AchData$Tendon, Genotype = P10AchData$Genotype, PC1 = P10AchPCA$ind$coord[,1], PC2 = P10AchPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P10AchPCA_plot <- P10AchPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P10AchPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P10AchPCA.svg", P10AchPCA_plot)
# Read in Data
Data <- read_excel("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/FinalData/DeltaCt_Wide.xlsx") %>%
mutate(SampleName = as_factor(SampleName), Age = as_factor(Age), Genotype = as_factor(Genotype), Tendon = as_factor(Tendon))
# recode to match ColXI paper existing figures
Data$Age <- recode_factor(Data$Age, p10 = "P10", p20 = "P20", p30 = "P30")
Data$Genotype <- recode_factor(Data$Genotype, WT = "CTRL")
# order factors
Data$Genotype <- factor(Data$Genotype, levels = c("CTRL", "HET", "KO"))
Data$Age <- factor(Data$Age, levels = c("P10", "P20", "P30"))
# remove idenitifers and housekeepers for data run through PCA
PCAData <- Data %>%
select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
colXIpalette <- c('#000000', '#ff0000', '#0432ff') # CTRL, HET, KO
# Global PCA - Genotype
globalPCA <- PCA(PCAData, graph = FALSE)
globalPCA_wid <- tibble(Sample = Data$SampleName, ComboID = paste0(Data$Age, "-", Data$Genotype), Age = Data$Age, Tendon = Data$Tendon, Genotype = Data$Genotype, PC1 = globalPCA$ind$coord[,1], PC2 = globalPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
globalPCA_genoplot <- globalPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
globalPCA_genoplot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_GlobalPCAGenotype.svg", globalPCA_genoplot)
# PCA by Age-Tendon
### P30 PT
P30PTData <- Data %>% filter(Tendon == "PT", Age == "P30")
P30PT_PCAData <- P30PTData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P30PTPCA <- PCA(P30PT_PCAData, graph = FALSE)
P30PTPCA_wid <- tibble(Sample = P30PTData$SampleName, ComboID = paste0(P30PTData$Age, "-", P30PTData$Genotype), Age = P30PTData$Age, Tendon = P30PTData$Tendon, Genotype = P30PTData$Genotype, PC1 = P30PTPCA$ind$coord[,1], PC2 = P30PTPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P30PTPCA_plot <- P30PTPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
xlim(c(-35,35))+
ylim(c(-22, 22))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P30PTPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P30PTPCA.svg", P30PTPCA_plot)
### P30 Ach
P30AchData <- Data %>% filter(Tendon == "Ach", Age == "P30")
P30Ach_PCAData <- P30AchData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P30AchPCA <- PCA(P30Ach_PCAData, graph = FALSE)
P30AchPCA_wid <- tibble(Sample = P30AchData$SampleName, ComboID = paste0(P30AchData$Age, "-", P30AchData$Genotype), Age = P30AchData$Age, Tendon = P30AchData$Tendon, Genotype = P30AchData$Genotype, PC1 = P30AchPCA$ind$coord[,1], PC2 = P30AchPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P30AchPCA_plot <- P30AchPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
xlim(c(-35,35))+
ylim(c(-22, 22))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P30AchPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P30AchPCA.svg", P30AchPCA_plot)
### P20 PT
P20PTData <- Data %>% filter(Tendon == "PT", Age == "P20")
P20PT_PCAData <- P20PTData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P20PTPCA <- PCA(P20PT_PCAData, graph = FALSE)
P20PTPCA_wid <- tibble(Sample = P20PTData$SampleName, ComboID = paste0(P20PTData$Age, "-", P20PTData$Genotype), Age = P20PTData$Age, Tendon = P20PTData$Tendon, Genotype = P20PTData$Genotype, PC1 = P20PTPCA$ind$coord[,1], PC2 = P20PTPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P20PTPCA_plot <- P20PTPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
xlim(c(-35,35))+
ylim(c(-22, 22))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P20PTPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P20PTPCA.svg", P20PTPCA_plot)
### P20 Ach
P20AchData <- Data %>% filter(Tendon == "Ach", Age == "P20")
P20Ach_PCAData <- P20AchData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P20AchPCA <- PCA(P20Ach_PCAData, graph = FALSE)
P20AchPCA_wid <- tibble(Sample = P20AchData$SampleName, ComboID = paste0(P20AchData$Age, "-", P20AchData$Genotype), Age = P20AchData$Age, Tendon = P20AchData$Tendon, Genotype = P20AchData$Genotype, PC1 = P20AchPCA$ind$coord[,1], PC2 = P20AchPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P20AchPCA_plot <- P20AchPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
xlim(c(-35,35))+
ylim(c(-22, 22))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P20AchPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P20AchPCA.svg", P20AchPCA_plot)
### P10 PT
P10PTData <- Data %>% filter(Tendon == "PT", Age == "P10")
P10PT_PCAData <- P10PTData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P10PTPCA <- PCA(P10PT_PCAData, graph = FALSE)
P10PTPCA_wid <- tibble(Sample =P10PTData$SampleName, ComboID = paste0(P10PTData$Age, "-", P10PTData$Genotype), Age = P10PTData$Age, Tendon = P10PTData$Tendon, Genotype = P10PTData$Genotype, PC1 = P10PTPCA$ind$coord[,1], PC2 = P10PTPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P10PTPCA_plot <- P10PTPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
xlim(c(-35,35))+
ylim(c(-22, 22))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P10PTPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P10PTPCA.svg", P10PTPCA_plot)
### P10 Ach
P10AchData <- Data %>% filter(Tendon == "Ach", Age == "P10")
P10Ach_PCAData <- P10AchData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P10AchPCA <- PCA(P10Ach_PCAData, graph = FALSE)
P10AchPCA_wid <- tibble(Sample = P10AchData$SampleName, ComboID = paste0(P10AchData$Age, "-", P10AchData$Genotype), Age = P10AchData$Age, Tendon = P10AchData$Tendon, Genotype = P10AchData$Genotype, PC1 = P10AchPCA$ind$coord[,1], PC2 = P10AchPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P10AchPCA_plot <- P10AchPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
xlim(c(-35,35))+
ylim(c(-22, 22))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P10AchPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P10AchPCA.svg", P10AchPCA_plot)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(readxl)
library(RColorBrewer)
library(forcats)
library(scales)
library(openxlsx)
library(reshape2)
library(factoextra)
library(FactoMineR)
library(ggprism)
library(ggrepel)
library(rstatix)
# Read in Data
Data <- read_excel("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/FinalData/DeltaCt_Wide.xlsx") %>%
mutate(SampleName = as_factor(SampleName), Age = as_factor(Age), Genotype = as_factor(Genotype), Tendon = as_factor(Tendon))
# recode to match ColXI paper existing figures
Data$Age <- recode_factor(Data$Age, p10 = "P10", p20 = "P20", p30 = "P30")
Data$Genotype <- recode_factor(Data$Genotype, WT = "CTRL")
# order factors
Data$Genotype <- factor(Data$Genotype, levels = c("CTRL", "HET", "KO"))
Data$Age <- factor(Data$Age, levels = c("P10", "P20", "P30"))
# remove idenitifers and housekeepers for data run through PCA
PCAData <- Data %>%
select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
colXIpalette <- c('#000000', '#ff0000', '#0432ff') # CTRL, HET, KO
# Global PCA
globalPCA <- PCA(PCAData, graph = FALSE)
globalPCA_wid <- tibble(Sample = Data$SampleName, ComboID = paste0(Data$Age, "-", Data$Genotype), Age = Data$Age, Tendon = Data$Tendon, Genotype = Data$Genotype, PC1 = globalPCA$ind$coord[,1], PC2 = globalPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
# PCA Plot by Genotype
globalPCA_genoplot <- globalPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
geom_text_repel(aes(label = Sample))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
globalPCA_genoplot
# PCA Plot by Age
globalPCA_ageplot <- globalPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Age, fill = Age)) +
geom_point(size = 2)+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_brewer(palette = 'Set2')+
scale_fill_brewer(palette = 'Set2')+
theme_bw()
globalPCA_ageplot
# PCA Plot by Tendon
globalPCA_tendplot <- globalPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Tendon, fill = Tendon)) +
geom_point(size = 2)+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_brewer(palette = 'Set1')+
scale_fill_brewer(palette = 'Set1')+
theme_bw()
globalPCA_tendplot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/OtherPCAPlots/GlobalPCA-Genotype.svg", globalPCA_genoplot)
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/OtherPCAPlots/GlobalPCA-Age.svg", globalPCA_ageplot)
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/OtherPCAPlots/GlobalPCA-Tendon.svg", globalPCA_tendplot)
# PCA by Age-Tendon
### P30 PT
P30PTData <- Data %>% filter(Tendon == "PT", Age == "P30")
P30PT_PCAData <- P30PTData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P30PTPCA <- PCA(P30PT_PCAData, graph = FALSE)
P30PTPCA_wid <- tibble(Sample = P30PTData$SampleName, ComboID = paste0(P30PTData$Age, "-", P30PTData$Genotype), Age = P30PTData$Age, Tendon = P30PTData$Tendon, Genotype = P30PTData$Genotype, PC1 = P30PTPCA$ind$coord[,1], PC2 = P30PTPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P30PTPCA_plot <- P30PTPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
geom_text_repel(aes(label = Sample))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P30PTPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P30PTPCA.svg", P30PTPCA_plot)
### P30 Ach
P30AchData <- Data %>% filter(Tendon == "Ach", Age == "P30")
P30Ach_PCAData <- P30AchData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P30AchPCA <- PCA(P30Ach_PCAData, graph = FALSE)
P30AchPCA_wid <- tibble(Sample = P30AchData$SampleName, ComboID = paste0(P30AchData$Age, "-", P30AchData$Genotype), Age = P30AchData$Age, Tendon = P30AchData$Tendon, Genotype = P30AchData$Genotype, PC1 = P30AchPCA$ind$coord[,1], PC2 = P30AchPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P30AchPCA_plot <- P30AchPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
geom_text_repel(aes(label = Sample))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P30AchPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P30AchPCA.svg", P30AchPCA_plot)
### P20 PT
P20PTData <- Data %>% filter(Tendon == "PT", Age == "P20")
P20PT_PCAData <- P20PTData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P20PTPCA <- PCA(P20PT_PCAData, graph = FALSE)
P20PTPCA_wid <- tibble(Sample = P20PTData$SampleName, ComboID = paste0(P20PTData$Age, "-", P20PTData$Genotype), Age = P20PTData$Age, Tendon = P20PTData$Tendon, Genotype = P20PTData$Genotype, PC1 = P20PTPCA$ind$coord[,1], PC2 = P20PTPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P20PTPCA_plot <- P20PTPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
geom_text_repel(aes(label = Sample))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P20PTPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P20PTPCA.svg", P20PTPCA_plot)
### P20 Ach
P20AchData <- Data %>% filter(Tendon == "Ach", Age == "P20")
P20Ach_PCAData <- P20AchData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P20AchPCA <- PCA(P20Ach_PCAData, graph = FALSE)
P20AchPCA_wid <- tibble(Sample = P20AchData$SampleName, ComboID = paste0(P20AchData$Age, "-", P20AchData$Genotype), Age = P20AchData$Age, Tendon = P20AchData$Tendon, Genotype = P20AchData$Genotype, PC1 = P20AchPCA$ind$coord[,1], PC2 = P20AchPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P20AchPCA_plot <- P20AchPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
geom_text_repel(aes(label = Sample))+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P20AchPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P20AchPCA.svg", P20AchPCA_plot)
### P10 PT
P10PTData <- Data %>% filter(Tendon == "PT", Age == "P10")
P10PT_PCAData <- P10PTData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P10PTPCA <- PCA(P10PT_PCAData, graph = FALSE)
P10PTPCA_wid <- tibble(Sample =P10PTData$SampleName, ComboID = paste0(P10PTData$Age, "-", P10PTData$Genotype), Age = P10PTData$Age, Tendon = P10PTData$Tendon, Genotype = P10PTData$Genotype, PC1 = P10PTPCA$ind$coord[,1], PC2 = P10PTPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P10PTPCA_plot <- P10PTPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P10PTPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P10PTPCA.svg", P10PTPCA_plot)
### P10 Ach
P10AchData <- Data %>% filter(Tendon == "Ach", Age == "P10")
P10Ach_PCAData <- P10AchData %>% select(-c(SampleName, Age, Genotype, Tendon, Abl1, Rps17, Rn18S, Col11a1))
P10AchPCA <- PCA(P10Ach_PCAData, graph = FALSE)
P10AchPCA_wid <- tibble(Sample = P10AchData$SampleName, ComboID = paste0(P10AchData$Age, "-", P10AchData$Genotype), Age = P10AchData$Age, Tendon = P10AchData$Tendon, Genotype = P10AchData$Genotype, PC1 = P10AchPCA$ind$coord[,1], PC2 = P10AchPCA$ind$coord[,2]) %>% mutate(ComboID = as_factor(ComboID))
P10AchPCA_plot <- P10AchPCA_wid %>%
ggplot(aes(x = PC1, y = PC2, color = Genotype, fill = Genotype)) +
geom_point(size = 2)+
stat_ellipse(geom = "polygon", alpha = 0.2, linewidth = 1.25) +
scale_color_manual(values = colXIpalette)+
scale_fill_manual(values = colXIpalette)+
theme_bw()
P10AchPCA_plot
ggsave("Z:/ABCs/Col_V_XI/Data/ColXI-Aim 1/Gene Replacement/Figure8_P10AchPCA.svg", P10AchPCA_plot)
#### Contributors
fviz_contrib(P30PTPCA, choice = 'var', sort.val = "desc", top = 10)
fviz_pca_biplot(P30PTPCA, select.var = list(name = "Spp1"), jitter = list(what = "label"))
View(P30PTPCA)
P30PTPCA[["var"]][["contrib"]]
fviz_contrib(P30PCA, choice = "var", top = 10)
fviz_contrib(P30PTPCA, choice = "var", top = 10)
fviz_contrib(P30PTPCA, choice = "var", top = 20)
fviz_contrib(P20PTPCA, choice = "var", top = 20)
fviz_contrib(P10PTPCA, choice = "var", top = 20)
fviz_contrib(P10AchPCA, choice = "var", top = 20)
fviz_contrib(P20AchPCA, choice = "var", top = 20)
fviz_contrib(P30AchPCA, choice = "var", top = 20)
get_pca(P30PTPCA)
P30PTPCAoutput <- get_pca(P30PTPCA)
View(P30PTPCAoutput)
View(P30PTPCA)
View(P30PTPCAoutput)
install.packages("shiny")
if(!requireNamespace("BiocManager", quietly = TRUE))+
install.packages("BiocManager")
BiocManager::install(version = "3.16")
setwd("C:/Users/nathu/Documents/Transcriptomics/kallisto")
setRepositories()
install.packages(c("rhdf5", "tidyverse", "tximport", "ensembldb"))
install.packages(c("EnsDb.Hsapiens.v86", "beepr"))
